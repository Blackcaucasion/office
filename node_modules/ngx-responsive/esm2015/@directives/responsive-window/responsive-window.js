import { __decorate } from "tslib";
/**
 * @name responsive-window
 * @description responsiveWindow Directive in ngx-responsive
 *
 * @license MIT
 */
import { DoCheck, Directive, Input, ElementRef, OnInit, OnDestroy, ChangeDetectorRef } from '@angular/core';
import { ResponsiveState } from '../../@core/providers/responsive-state/responsive-state';
import { ResponsiveConfig } from "../../@core/providers/responsive-config/responsive-config";
import { map } from "rxjs/operators";
import { PlatformService } from '../../@core/providers/platform-service/platform.service';
let ResponsiveWindowDirective = class ResponsiveWindowDirective {
    constructor(_responsiveState, el, cd, platformService, _responsiveConfig) {
        this._responsiveState = _responsiveState;
        this.el = el;
        this.cd = cd;
        this._responsiveConfig = _responsiveConfig;
        this._isEnabledForPlatform = null;
        this._isEnabledForPlatform = platformService.isEnabledForPlatform();
        if (this._isEnabledForPlatform) {
            this.element = el.nativeElement;
        }
        this.currentBreakpoint$ = this._responsiveState
            .ancho$
            .pipe(map(this.getCurrentBreakpoint.bind(this)));
    }
    ngOnInit() {
        if (this._isEnabledForPlatform) {
            this._responsiveState.registerWindow(this);
        }
    }
    ngDoCheck() {
        if (this._isEnabledForPlatform) {
            const _update = this._ifValueChanged(this._noRepeat, this.name);
            if (_update) {
                this._responsiveState.unregisterWindow(this);
                this._responsiveState.registerWindow(this);
                this.cd.markForCheck();
            }
        }
    }
    ngOnDestroy() {
        if (this._isEnabledForPlatform) {
            this._responsiveState.unregisterWindow(this);
        }
    }
    getWidth() {
        return (this._isEnabledForPlatform) ? this.element.offsetWidth : 0;
    }
    getCurrentBreakpoint() {
        const width = this.getWidth();
        // console.error("getCurrentBreakpoint", width)
        if (this._responsiveConfig.config.breakPoints.xl.min <= width) {
            return 'xl';
        }
        else if (this._responsiveConfig.config.breakPoints.lg.max >= width && this._responsiveConfig.config.breakPoints.lg.min <= width) {
            return 'lg';
        }
        else if (this._responsiveConfig.config.breakPoints.md.max >= width && this._responsiveConfig.config.breakPoints.md.min <= width) {
            return 'md';
        }
        else if (this._responsiveConfig.config.breakPoints.sm.max >= width && this._responsiveConfig.config.breakPoints.sm.min <= width) {
            return 'sm';
        }
        else if (this._responsiveConfig.config.breakPoints.xs.max >= width) {
            return 'xs';
        }
    }
    _ifValueChanged(oldValue, newValue) {
        if (oldValue === newValue) {
            return false;
        }
        else {
            this._noRepeat = newValue;
            return true;
        }
    }
};
ResponsiveWindowDirective.ctorParameters = () => [
    { type: ResponsiveState },
    { type: ElementRef },
    { type: ChangeDetectorRef },
    { type: PlatformService },
    { type: ResponsiveConfig }
];
__decorate([
    Input('responsive-window')
], ResponsiveWindowDirective.prototype, "name", void 0);
ResponsiveWindowDirective = __decorate([
    Directive({
        selector: "[responsive-window]",
        exportAs: "container"
    })
], ResponsiveWindowDirective);
export { ResponsiveWindowDirective };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVzcG9uc2l2ZS13aW5kb3cuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9uZ3gtcmVzcG9uc2l2ZS8iLCJzb3VyY2VzIjpbIkBkaXJlY3RpdmVzL3Jlc3BvbnNpdmUtd2luZG93L3Jlc3BvbnNpdmUtd2luZG93LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTs7Ozs7R0FLRztBQUNILE9BQU8sRUFBRSxPQUFPLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBRSxVQUFVLEVBQUUsTUFBTSxFQUFFLFNBQVMsRUFBRSxpQkFBaUIsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUc1RyxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0seURBQXlELENBQUM7QUFDMUYsT0FBTyxFQUFFLGdCQUFnQixFQUFFLE1BQU0sMkRBQTJELENBQUM7QUFFN0YsT0FBTyxFQUFFLEdBQUcsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ3JDLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSx5REFBeUQsQ0FBQztBQU0xRixJQUFhLHlCQUF5QixHQUF0QyxNQUFhLHlCQUF5QjtJQVVsQyxZQUNZLGdCQUFpQyxFQUNqQyxFQUFjLEVBQ2QsRUFBcUIsRUFDN0IsZUFBZ0MsRUFDeEIsaUJBQW1DO1FBSm5DLHFCQUFnQixHQUFoQixnQkFBZ0IsQ0FBaUI7UUFDakMsT0FBRSxHQUFGLEVBQUUsQ0FBWTtRQUNkLE9BQUUsR0FBRixFQUFFLENBQW1CO1FBRXJCLHNCQUFpQixHQUFqQixpQkFBaUIsQ0FBa0I7UUFYdkMsMEJBQXFCLEdBQVksSUFBSSxDQUFDO1FBYTFDLElBQUksQ0FBQyxxQkFBcUIsR0FBRyxlQUFlLENBQUMsb0JBQW9CLEVBQUUsQ0FBQztRQUNwRSxJQUFJLElBQUksQ0FBQyxxQkFBcUIsRUFBRTtZQUM1QixJQUFJLENBQUMsT0FBTyxHQUFHLEVBQUUsQ0FBQyxhQUFhLENBQUM7U0FDbkM7UUFFRCxJQUFJLENBQUMsa0JBQWtCLEdBQUcsSUFBSSxDQUFDLGdCQUFnQjthQUMxQyxNQUFNO2FB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aUJBQWlCO1lBQ1osZUFBZTtZQUNMLGdCQUFnQjs7QUFUbkI7SUFBM0IsS0FBSyxDQUFDLG1CQUFtQixDQUFDO3VEQUFjO0FBTmhDLHlCQUF5QjtJQUpyQyxTQUFTLENBQUM7UUFDUCxRQUFRLEVBQUUscUJBQXFCO1FBQy9CLFFBQVEsRUFBRSxXQUFXO0tBQ3hCLENBQUM7R0FDVyx5QkFBeUIsQ0ErRXJDO1NBL0VZLHlCQUF5QiIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBAbmFtZSByZXNwb25zaXZlLXdpbmRvd1xyXG4gKiBAZGVzY3JpcHRpb24gcmVzcG9uc2l2ZVdpbmRvdyBEaXJlY3RpdmUgaW4gbmd4LXJlc3BvbnNpdmVcclxuICpcclxuICogQGxpY2Vuc2UgTUlUXHJcbiAqL1xyXG5pbXBvcnQgeyBEb0NoZWNrLCBEaXJlY3RpdmUsIElucHV0LCBFbGVtZW50UmVmLCBPbkluaXQsIE9uRGVzdHJveSwgQ2hhbmdlRGV0ZWN0b3JSZWYgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgUExBVEZPUk1fSUQsIEluamVjdCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBpc1BsYXRmb3JtQnJvd3NlciB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XHJcbmltcG9ydCB7IFJlc3BvbnNpdmVTdGF0ZSB9IGZyb20gJy4uLy4uL0Bjb3JlL3Byb3ZpZGVycy9yZXNwb25zaXZlLXN0YXRlL3Jlc3BvbnNpdmUtc3RhdGUnO1xyXG5pbXBvcnQgeyBSZXNwb25zaXZlQ29uZmlnIH0gZnJvbSBcIi4uLy4uL0Bjb3JlL3Byb3ZpZGVycy9yZXNwb25zaXZlLWNvbmZpZy9yZXNwb25zaXZlLWNvbmZpZ1wiO1xyXG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSBcInJ4anNcIjtcclxuaW1wb3J0IHsgbWFwIH0gZnJvbSBcInJ4anMvb3BlcmF0b3JzXCI7XHJcbmltcG9ydCB7IFBsYXRmb3JtU2VydmljZSB9IGZyb20gJy4uLy4uL0Bjb3JlL3Byb3ZpZGVycy9wbGF0Zm9ybS1zZXJ2aWNlL3BsYXRmb3JtLnNlcnZpY2UnO1xyXG5cclxuQERpcmVjdGl2ZSh7XHJcbiAgICBzZWxlY3RvcjogXCJbcmVzcG9uc2l2ZS13aW5kb3ddXCIsXHJcbiAgICBleHBvcnRBczogXCJjb250YWluZXJcIlxyXG59KVxyXG5leHBvcnQgY2xhc3MgUmVzcG9uc2l2ZVdpbmRvd0RpcmVjdGl2ZSBpbXBsZW1lbnRzIE9uSW5pdCwgT25EZXN0cm95LCBEb0NoZWNrIHtcclxuXHJcbiAgICBwcml2YXRlIF9ub1JlcGVhdDogc3RyaW5nO1xyXG4gICAgcHJpdmF0ZSBlbGVtZW50OiBIVE1MRWxlbWVudDtcclxuICAgIHByaXZhdGUgX2lzRW5hYmxlZEZvclBsYXRmb3JtOiBib29sZWFuID0gbnVsbDtcclxuXHJcbiAgICBASW5wdXQoJ3Jlc3BvbnNpdmUtd2luZG93JykgbmFtZTogc3RyaW5nO1xyXG5cclxuICAgIHB1YmxpYyBjdXJyZW50QnJlYWtwb2ludCQ6IE9ic2VydmFibGU8c3RyaW5nPjtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihcclxuICAgICAgICBwcml2YXRlIF9yZXNwb25zaXZlU3RhdGU6IFJlc3BvbnNpdmVTdGF0ZSxcclxuICAgICAgICBwcml2YXRlIGVsOiBFbGVtZW50UmVmLFxyXG4gICAgICAgIHByaXZhdGUgY2Q6IENoYW5nZURldGVjdG9yUmVmLFxyXG4gICAgICAgIHBsYXRmb3JtU2VydmljZTogUGxhdGZvcm1TZXJ2aWNlLFxyXG4gICAgICAgIHByaXZhdGUgX3Jlc3BvbnNpdmVDb25maWc6IFJlc3BvbnNpdmVDb25maWcpIHtcclxuXHJcbiAgICAgICAgdGhpcy5faXNFbmFibGVkRm9yUGxhdGZvcm0gPSBwbGF0Zm9ybVNlcnZpY2UuaXNFbmFibGVkRm9yUGxhdGZvcm0oKTtcclxuICAgICAgICBpZiAodGhpcy5faXNFbmFibGVkRm9yUGxhdGZvcm0pIHtcclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50ID0gZWwubmF0aXZlRWxlbWVudDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuY3VycmVudEJyZWFrcG9pbnQkID0gdGhpcy5fcmVzcG9uc2l2ZVN0YXRlXHJcbiAgICAgICAgICAgIC5hbmNobyRcclxuICAgICAgICAgICAgLnBpcGUoXHJcbiAgICAgICAgICAgICAgICBtYXAodGhpcy5nZXRDdXJyZW50QnJlYWtwb2ludC5iaW5kKHRoaXMpKVxyXG4gICAgICAgICAgICApO1xyXG4gICAgfVxyXG4gICAgcHVibGljIG5nT25Jbml0KCk6IHZvaWQge1xyXG4gICAgICAgIGlmICh0aGlzLl9pc0VuYWJsZWRGb3JQbGF0Zm9ybSkge1xyXG4gICAgICAgICAgICB0aGlzLl9yZXNwb25zaXZlU3RhdGUucmVnaXN0ZXJXaW5kb3codGhpcyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBuZ0RvQ2hlY2soKTogdm9pZCB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2lzRW5hYmxlZEZvclBsYXRmb3JtKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IF91cGRhdGUgPSB0aGlzLl9pZlZhbHVlQ2hhbmdlZCh0aGlzLl9ub1JlcGVhdCwgdGhpcy5uYW1lKTtcclxuICAgICAgICAgICAgaWYgKF91cGRhdGUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3Jlc3BvbnNpdmVTdGF0ZS51bnJlZ2lzdGVyV2luZG93KHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcmVzcG9uc2l2ZVN0YXRlLnJlZ2lzdGVyV2luZG93KHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jZC5tYXJrRm9yQ2hlY2soKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHB1YmxpYyBuZ09uRGVzdHJveSgpIHtcclxuICAgICAgICBpZiAodGhpcy5faXNFbmFibGVkRm9yUGxhdGZvcm0pIHtcclxuICAgICAgICAgICAgdGhpcy5fcmVzcG9uc2l2ZVN0YXRlLnVucmVnaXN0ZXJXaW5kb3codGhpcyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBnZXRXaWR0aCgpIHtcclxuICAgICAgICByZXR1cm4gKHRoaXMuX2lzRW5hYmxlZEZvclBsYXRmb3JtKSA/IHRoaXMuZWxlbWVudC5vZmZzZXRXaWR0aCA6IDA7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGdldEN1cnJlbnRCcmVha3BvaW50KCk6IHN0cmluZyB7XHJcbiAgICAgICAgY29uc3Qgd2lkdGg6IG51bWJlciA9IHRoaXMuZ2V0V2lkdGgoKTtcclxuICAgICAgICAvLyBjb25zb2xlLmVycm9yKFwiZ2V0Q3VycmVudEJyZWFrcG9pbnRcIiwgd2lkdGgpXHJcbiAgICAgICAgaWYgKHRoaXMuX3Jlc3BvbnNpdmVDb25maWcuY29uZmlnLmJyZWFrUG9pbnRzLnhsLm1pbiA8PSB3aWR0aCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJ3hsJztcclxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuX3Jlc3BvbnNpdmVDb25maWcuY29uZmlnLmJyZWFrUG9pbnRzLmxnLm1heCA+PSB3aWR0aCAmJiB0aGlzLl9yZXNwb25zaXZlQ29uZmlnLmNvbmZpZy5icmVha1BvaW50cy5sZy5taW4gPD0gd2lkdGgpIHtcclxuICAgICAgICAgICAgcmV0dXJuICdsZyc7XHJcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLl9yZXNwb25zaXZlQ29uZmlnLmNvbmZpZy5icmVha1BvaW50cy5tZC5tYXggPj0gd2lkdGggJiYgdGhpcy5fcmVzcG9uc2l2ZUNvbmZpZy5jb25maWcuYnJlYWtQb2ludHMubWQubWluIDw9IHdpZHRoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAnbWQnO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5fcmVzcG9uc2l2ZUNvbmZpZy5jb25maWcuYnJlYWtQb2ludHMuc20ubWF4ID49IHdpZHRoICYmIHRoaXMuX3Jlc3BvbnNpdmVDb25maWcuY29uZmlnLmJyZWFrUG9pbnRzLnNtLm1pbiA8PSB3aWR0aCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJ3NtJztcclxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuX3Jlc3BvbnNpdmVDb25maWcuY29uZmlnLmJyZWFrUG9pbnRzLnhzLm1heCA+PSB3aWR0aCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJ3hzJztcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG5cclxuICAgIHByaXZhdGUgX2lmVmFsdWVDaGFuZ2VkKG9sZFZhbHVlOiBhbnksIG5ld1ZhbHVlOiBhbnkpOiBib29sZWFuIHtcclxuICAgICAgICBpZiAob2xkVmFsdWUgPT09IG5ld1ZhbHVlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9ub1JlcGVhdCA9IG5ld1ZhbHVlO1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuIl19