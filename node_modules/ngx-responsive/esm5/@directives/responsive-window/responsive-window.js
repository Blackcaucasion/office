import { __decorate } from "tslib";
/**
 * @name responsive-window
 * @description responsiveWindow Directive in ngx-responsive
 *
 * @license MIT
 */
import { DoCheck, Directive, Input, ElementRef, OnInit, OnDestroy, ChangeDetectorRef } from '@angular/core';
import { ResponsiveState } from '../../@core/providers/responsive-state/responsive-state';
import { ResponsiveConfig } from "../../@core/providers/responsive-config/responsive-config";
import { map } from "rxjs/operators";
import { PlatformService } from '../../@core/providers/platform-service/platform.service';
var ResponsiveWindowDirective = /** @class */ (function () {
    function ResponsiveWindowDirective(_responsiveState, el, cd, platformService, _responsiveConfig) {
        this._responsiveState = _responsiveState;
        this.el = el;
        this.cd = cd;
        this._responsiveConfig = _responsiveConfig;
        this._isEnabledForPlatform = null;
        this._isEnabledForPlatform = platformService.isEnabledForPlatform();
        if (this._isEnabledForPlatform) {
            this.element = el.nativeElement;
        }
        this.currentBreakpoint$ = this._responsiveState
            .ancho$
            .pipe(map(this.getCurrentBreakpoint.bind(this)));
    }
    ResponsiveWindowDirective.prototype.ngOnInit = function () {
        if (this._isEnabledForPlatform) {
            this._responsiveState.registerWindow(this);
        }
    };
    ResponsiveWindowDirective.prototype.ngDoCheck = function () {
        if (this._isEnabledForPlatform) {
            var _update = this._ifValueChanged(this._noRepeat, this.name);
            if (_update) {
                this._responsiveState.unregisterWindow(this);
                this._responsiveState.registerWindow(this);
                this.cd.markForCheck();
            }
        }
    };
    ResponsiveWindowDirective.prototype.ngOnDestroy = function () {
        if (this._isEnabledForPlatform) {
            this._responsiveState.unregisterWindow(this);
        }
    };
    ResponsiveWindowDirective.prototype.getWidth = function () {
        return (this._isEnabledForPlatform) ? this.element.offsetWidth : 0;
    };
    ResponsiveWindowDirective.prototype.getCurrentBreakpoint = function () {
        var width = this.getWidth();
        // console.error("getCurrentBreakpoint", width)
        if (this._responsiveConfig.config.breakPoints.xl.min <= width) {
            return 'xl';
        }
        else if (this._responsiveConfig.config.breakPoints.lg.max >= width && this._responsiveConfig.config.breakPoints.lg.min <= width) {
            return 'lg';
        }
        else if (this._responsiveConfig.config.breakPoints.md.max >= width && this._responsiveConfig.config.breakPoints.md.min <= width) {
            return 'md';
        }
        else if (this._responsiveConfig.config.breakPoints.sm.max >= width && this._responsiveConfig.config.breakPoints.sm.min <= width) {
            return 'sm';
        }
        else if (this._responsiveConfig.config.breakPoints.xs.max >= width) {
            return 'xs';
        }
    };
    ResponsiveWindowDirective.prototype._ifValueChanged = function (oldValue, newValue) {
        if (oldValue === newValue) {
            return false;
        }
        else {
            this._noRepeat = newValue;
            return true;
        }
    };
    ResponsiveWindowDirective.ctorParameters = function () { return [
        { type: ResponsiveState },
        { type: ElementRef },
        { type: ChangeDetectorRef },
        { type: PlatformService },
        { type: ResponsiveConfig }
    ]; };
    __decorate([
        Input('responsive-window')
    ], ResponsiveWindowDirective.prototype, "name", void 0);
    ResponsiveWindowDirective = __decorate([
        Directive({
            selector: "[responsive-window]",
            exportAs: "container"
        })
    ], ResponsiveWindowDirective);
    return ResponsiveWindowDirective;
}());
export { ResponsiveWindowDirective };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVzcG9uc2l2ZS13aW5kb3cuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9uZ3gtcmVzcG9uc2l2ZS8iLCJzb3VyY2VzIjpbIkBkaXJlY3RpdmVzL3Jlc3BvbnNpdmUtd2luZG93L3Jlc3BvbnNpdmUtd2luZG93LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTs7Ozs7R0FLRztBQUNILE9BQU8sRUFBRSxPQUFPLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBRSxVQUFVLEVBQUUsTUFBTSxFQUFFLFNBQVMsRUFBRSxpQkFBaUIsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUc1RyxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0seURBQXlELENBQUM7QUFDMUYsT0FBTyxFQUFFLGdCQUFnQixFQUFFLE1BQU0sMkRBQTJELENBQUM7QUFFN0YsT0FBTyxFQUFFLEdBQUcsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ3JDLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSx5REFBeUQsQ0FBQztBQU0xRjtJQVVJLG1DQUNZLGdCQUFpQyxFQUNqQyxFQUFjLEVBQ2QsRUFBcUIsRUFDN0IsZUFBZ0MsRUFDeEIsaUJBQW1DO1FBSm5DLHFCQUFnQixHQUFoQixnQkFBZ0IsQ0FBaUI7UUFDakMsT0FBRSxHQUFGLEVBQUUsQ0FBWTtRQUNkLE9BQUUsR0FBRixFQUFFLENBQW1CO1FBRXJCLHNCQUFpQixHQUFqQixpQkFBaUIsQ0FBa0I7UUFYdkMsMEJBQXFCLEdBQVksSUFBSSxDQUFDO1FBYTFDLElBQUksQ0FBQyxxQkFBcUIsR0FBRyxlQUFlLENBQUMsb0JBQW9CLEVBQUUsQ0FBQztRQUNwRSxJQUFJLElBQUksQ0FBQyxxQkFBcUIsRUFBRTtZQUM1QixJQUFJLENBQUMsT0FBTyxHQUFHLEVBQUUsQ0FBQyxhQUFhLENBQUM7U0FDbkM7UUFFRCxJQUFJLENBQUMsa0JBQWtCLEdBQUcsSUFBSSxDQUFDLGdCQUFnQjthQUMxQyxNQUFNO2FBQ04sSUFBSSxDQUNELEdBQUcsQ0FBQyxJQUFJLENB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VixpQkFBaUI7Z0JBQ1osZUFBZTtnQkFDTCxnQkFBZ0I7O0lBVG5CO1FBQTNCLEtBQUssQ0FBQyxtQkFBbUIsQ0FBQzsyREFBYztJQU5oQyx5QkFBeUI7UUFKckMsU0FBUyxDQUFDO1lBQ1AsUUFBUSxFQUFFLHFCQUFxQjtZQUMvQixRQUFRLEVBQUUsV0FBVztTQUN4QixDQUFDO09BQ1cseUJBQXlCLENBK0VyQztJQUFELGdDQUFDO0NBQUEsQUEvRUQsSUErRUM7U0EvRVkseUJBQXlCIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIEBuYW1lIHJlc3BvbnNpdmUtd2luZG93XHJcbiAqIEBkZXNjcmlwdGlvbiByZXNwb25zaXZlV2luZG93IERpcmVjdGl2ZSBpbiBuZ3gtcmVzcG9uc2l2ZVxyXG4gKlxyXG4gKiBAbGljZW5zZSBNSVRcclxuICovXHJcbmltcG9ydCB7IERvQ2hlY2ssIERpcmVjdGl2ZSwgSW5wdXQsIEVsZW1lbnRSZWYsIE9uSW5pdCwgT25EZXN0cm95LCBDaGFuZ2VEZXRlY3RvclJlZiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBQTEFURk9STV9JRCwgSW5qZWN0IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IGlzUGxhdGZvcm1Ccm93c2VyIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uJztcclxuaW1wb3J0IHsgUmVzcG9uc2l2ZVN0YXRlIH0gZnJvbSAnLi4vLi4vQGNvcmUvcHJvdmlkZXJzL3Jlc3BvbnNpdmUtc3RhdGUvcmVzcG9uc2l2ZS1zdGF0ZSc7XHJcbmltcG9ydCB7IFJlc3BvbnNpdmVDb25maWcgfSBmcm9tIFwiLi4vLi4vQGNvcmUvcHJvdmlkZXJzL3Jlc3BvbnNpdmUtY29uZmlnL3Jlc3BvbnNpdmUtY29uZmlnXCI7XHJcbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tIFwicnhqc1wiO1xyXG5pbXBvcnQgeyBtYXAgfSBmcm9tIFwicnhqcy9vcGVyYXRvcnNcIjtcclxuaW1wb3J0IHsgUGxhdGZvcm1TZXJ2aWNlIH0gZnJvbSAnLi4vLi4vQGNvcmUvcHJvdmlkZXJzL3BsYXRmb3JtLXNlcnZpY2UvcGxhdGZvcm0uc2VydmljZSc7XHJcblxyXG5ARGlyZWN0aXZlKHtcclxuICAgIHNlbGVjdG9yOiBcIltyZXNwb25zaXZlLXdpbmRvd11cIixcclxuICAgIGV4cG9ydEFzOiBcImNvbnRhaW5lclwiXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBSZXNwb25zaXZlV2luZG93RGlyZWN0aXZlIGltcGxlbWVudHMgT25Jbml0LCBPbkRlc3Ryb3ksIERvQ2hlY2sge1xyXG5cclxuICAgIHByaXZhdGUgX25vUmVwZWF0OiBzdHJpbmc7XHJcbiAgICBwcml2YXRlIGVsZW1lbnQ6IEhUTUxFbGVtZW50O1xyXG4gICAgcHJpdmF0ZSBfaXNFbmFibGVkRm9yUGxhdGZvcm06IGJvb2xlYW4gPSBudWxsO1xyXG5cclxuICAgIEBJbnB1dCgncmVzcG9uc2l2ZS13aW5kb3cnKSBuYW1lOiBzdHJpbmc7XHJcblxyXG4gICAgcHVibGljIGN1cnJlbnRCcmVha3BvaW50JDogT2JzZXJ2YWJsZTxzdHJpbmc+O1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKFxyXG4gICAgICAgIHByaXZhdGUgX3Jlc3BvbnNpdmVTdGF0ZTogUmVzcG9uc2l2ZVN0YXRlLFxyXG4gICAgICAgIHByaXZhdGUgZWw6IEVsZW1lbnRSZWYsXHJcbiAgICAgICAgcHJpdmF0ZSBjZDogQ2hhbmdlRGV0ZWN0b3JSZWYsXHJcbiAgICAgICAgcGxhdGZvcm1TZXJ2aWNlOiBQbGF0Zm9ybVNlcnZpY2UsXHJcbiAgICAgICAgcHJpdmF0ZSBfcmVzcG9uc2l2ZUNvbmZpZzogUmVzcG9uc2l2ZUNvbmZpZykge1xyXG5cclxuICAgICAgICB0aGlzLl9pc0VuYWJsZWRGb3JQbGF0Zm9ybSA9IHBsYXRmb3JtU2VydmljZS5pc0VuYWJsZWRGb3JQbGF0Zm9ybSgpO1xyXG4gICAgICAgIGlmICh0aGlzLl9pc0VuYWJsZWRGb3JQbGF0Zm9ybSkge1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQgPSBlbC5uYXRpdmVFbGVtZW50O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5jdXJyZW50QnJlYWtwb2ludCQgPSB0aGlzLl9yZXNwb25zaXZlU3RhdGVcclxuICAgICAgICAgICAgLmFuY2hvJFxyXG4gICAgICAgICAgICAucGlwZShcclxuICAgICAgICAgICAgICAgIG1hcCh0aGlzLmdldEN1cnJlbnRCcmVha3BvaW50LmJpbmQodGhpcykpXHJcbiAgICAgICAgICAgICk7XHJcbiAgICB9XHJcbiAgICBwdWJsaWMgbmdPbkluaXQoKTogdm9pZCB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2lzRW5hYmxlZEZvclBsYXRmb3JtKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3Jlc3BvbnNpdmVTdGF0ZS5yZWdpc3RlcldpbmRvdyh0aGlzKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIG5nRG9DaGVjaygpOiB2b2lkIHtcclxuICAgICAgICBpZiAodGhpcy5faXNFbmFibGVkRm9yUGxhdGZvcm0pIHtcclxuICAgICAgICAgICAgY29uc3QgX3VwZGF0ZSA9IHRoaXMuX2lmVmFsdWVDaGFuZ2VkKHRoaXMuX25vUmVwZWF0LCB0aGlzLm5hbWUpO1xyXG4gICAgICAgICAgICBpZiAoX3VwZGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcmVzcG9uc2l2ZVN0YXRlLnVucmVnaXN0ZXJXaW5kb3codGhpcyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9yZXNwb25zaXZlU3RhdGUucmVnaXN0ZXJXaW5kb3codGhpcyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNkLm1hcmtGb3JDaGVjaygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcHVibGljIG5nT25EZXN0cm95KCkge1xyXG4gICAgICAgIGlmICh0aGlzLl9pc0VuYWJsZWRGb3JQbGF0Zm9ybSkge1xyXG4gICAgICAgICAgICB0aGlzLl9yZXNwb25zaXZlU3RhdGUudW5yZWdpc3RlcldpbmRvdyh0aGlzKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGdldFdpZHRoKCkge1xyXG4gICAgICAgIHJldHVybiAodGhpcy5faXNFbmFibGVkRm9yUGxhdGZvcm0pID8gdGhpcy5lbGVtZW50Lm9mZnNldFdpZHRoIDogMDtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZ2V0Q3VycmVudEJyZWFrcG9pbnQoKTogc3RyaW5nIHtcclxuICAgICAgICBjb25zdCB3aWR0aDogbnVtYmVyID0gdGhpcy5nZXRXaWR0aCgpO1xyXG4gICAgICAgIC8vIGNvbnNvbGUuZXJyb3IoXCJnZXRDdXJyZW50QnJlYWtwb2ludFwiLCB3aWR0aClcclxuICAgICAgICBpZiAodGhpcy5fcmVzcG9uc2l2ZUNvbmZpZy5jb25maWcuYnJlYWtQb2ludHMueGwubWluIDw9IHdpZHRoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAneGwnO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5fcmVzcG9uc2l2ZUNvbmZpZy5jb25maWcuYnJlYWtQb2ludHMubGcubWF4ID49IHdpZHRoICYmIHRoaXMuX3Jlc3BvbnNpdmVDb25maWcuY29uZmlnLmJyZWFrUG9pbnRzLmxnLm1pbiA8PSB3aWR0aCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJ2xnJztcclxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuX3Jlc3BvbnNpdmVDb25maWcuY29uZmlnLmJyZWFrUG9pbnRzLm1kLm1heCA+PSB3aWR0aCAmJiB0aGlzLl9yZXNwb25zaXZlQ29uZmlnLmNvbmZpZy5icmVha1BvaW50cy5tZC5taW4gPD0gd2lkdGgpIHtcclxuICAgICAgICAgICAgcmV0dXJuICdtZCc7XHJcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLl9yZXNwb25zaXZlQ29uZmlnLmNvbmZpZy5icmVha1BvaW50cy5zbS5tYXggPj0gd2lkdGggJiYgdGhpcy5fcmVzcG9uc2l2ZUNvbmZpZy5jb25maWcuYnJlYWtQb2ludHMuc20ubWluIDw9IHdpZHRoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAnc20nO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5fcmVzcG9uc2l2ZUNvbmZpZy5jb25maWcuYnJlYWtQb2ludHMueHMubWF4ID49IHdpZHRoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAneHMnO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcblxyXG4gICAgcHJpdmF0ZSBfaWZWYWx1ZUNoYW5nZWQob2xkVmFsdWU6IGFueSwgbmV3VmFsdWU6IGFueSk6IGJvb2xlYW4ge1xyXG4gICAgICAgIGlmIChvbGRWYWx1ZSA9PT0gbmV3VmFsdWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX25vUmVwZWF0ID0gbmV3VmFsdWU7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG4iXX0=